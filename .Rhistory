branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
setwd("~/Desktop/branch-arch")
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
treesum <- read.csv("TreeSummary.csv", sep = ",", head=T)
library('smatr')
tree_graph <- function(x, y, test, pred_b, pred_m, labx, laby, position, R2){
plot(log10(x[1:19]), log10(y[1:19]),
xlim = c((log10(min(x))-0.2),(log10(max(x))+0.2)), ylim = c((log10(min(y))-0.2),(log10(max(y))+0.2)),
xlab = labx, ylab = laby, cex.lab = 1.5, cex = 2.5, pch = 19, col = "black")
points(log10(x[20:24]), log10(y[20:24]), cex = 2.5, pch = 19, col = "red", bg = "red")
abline(coef.sma(test)[1], coef.sma(test)[2], lwd = 3, lty = 2)
abline(sma(test)$coef[[1]][1,2], sma(test)$coef[[1]][2,2], lwd = 3, lty = 3)
abline(sma(test)$coef[[1]][1,3], sma(test)$coef[[1]][2,3], lwd = 3, lty = 3)
abline(pred_b, pred_m, lwd = 3, lty = 1)
legend(position, legend=R2, bty='n', cex=3)
} #tree-level figures
branch_graph <- function(x, y, test, pred_b, pred_m, labx, laby, position, R2){
group_data_x <- list()
group_data_x[[1]] <- x[x$species=="cherry",]
apple <- x[x$species=="apple",]
group_data_x[[2]] <- subset(apple, tree==20 | tree==19 | tree==14)
group_data_x[[3]] <- subset(apple, tree==17 | tree==15 | tree==18)
group_data_x[[4]] <- subset(apple, tree==13)
group_data_x[[5]] <- subset(apple, tree==10 | tree==1 | tree==4 | tree ==9)
group_data_x[[6]] <- subset(apple, tree==5 | tree==11 | tree==6 | tree ==8)
group_data_x[[7]] <- subset(apple, tree==2 | tree==7 | tree==12 | tree ==3)
group_data_y <- list()
group_data_y[[1]] <- y[y$species=="cherry",]
apple <- y[y$species=="apple",]
group_data_y[[2]] <- subset(apple, tree==20 | tree==19 | tree==14)
group_data_y[[3]] <- subset(apple, tree==17 | tree==15 | tree==18)
group_data_y[[4]] <- subset(apple, tree==13)
group_data_y[[5]] <- subset(apple, tree==10 | tree==1 | tree==4 | tree ==9)
group_data_y[[6]] <- subset(apple, tree==5 | tree==11 | tree==6 | tree ==8)
group_data_y[[7]] <- subset(apple, tree==2 | tree==7 | tree==12 | tree ==3)
plot(log10(group_data_x[[1]][,3]), log10(group_data_y[[1]][,3]),
xlim = c((log10(min(x[,3], na.rm=T))-0.2),(log10(max(x[,3], na.rm=T))+0.2)),
ylim = c((log10(min(y[,3], na.rm=T))-0.2),(log10(max(y[,3], na.rm=T))+0.2)),
xlab = labx, ylab = laby, cex.lab = 1.5, cex = 1.5, pch = 21, col = "red", bg = "red")
points(log10(group_data_x[[2]][,3]), log10(group_data_y[[2]][,3]), cex = 1.5, pch = 21, col = "black", bg = "orange")
points(log10(group_data_x[[3]][,3]), log10(group_data_y[[3]][,3]), cex = 1.5, pch = 21, col = "black", bg = 'yellow')
points(log10(group_data_x[[4]][,3]), log10(group_data_y[[4]][,3]), cex = 1.5, pch = 21, col = "black", bg = 'green')
points(log10(group_data_x[[5]][,3]), log10(group_data_y[[5]][,3]), cex = 1.5, pch = 21, col = "black", bg = 'cyan')
points(log10(group_data_x[[6]][,3]), log10(group_data_y[[6]][,3]), cex = 1.5, pch = 21, col = "black", bg = 'blue')
points(log10(group_data_x[[7]][,3]), log10(group_data_y[[7]][,3]), cex = 1.5, pch = 21, col = "black", bg = 'purple')
abline(coef.sma(test)[1], coef.sma(test)[2], lwd = 3, lty = 2)
abline(sma(test)$coef[[1]][1,2], sma(test)$coef[[1]][2,2], lwd = 3, lty = 3)
abline(sma(test)$coef[[1]][1,3], sma(test)$coef[[1]][2,3], lwd = 3, lty = 3)
abline(pred_b, pred_m, lwd = 3, lty = 1)
legend(position, legend=R2, bty='n', cex=3)
} #branch-level log10-trans
branch_graph2 <- function(x, y, test, pred_b, pred_m, labx, laby, position, R2){
group_data_x <- list()
group_data_x[[1]] <- x[x$species=="cherry",]
apple <- x[x$species=="apple",]
group_data_x[[2]] <- subset(apple, tree==20 | tree==19 | tree==14)
group_data_x[[3]] <- subset(apple, tree==17 | tree==15 | tree==18)
group_data_x[[4]] <- subset(apple, tree==13)
group_data_x[[5]] <- subset(apple, tree==10 | tree==1 | tree==4 | tree ==9)
group_data_x[[6]] <- subset(apple, tree==5 | tree==11 | tree==6 | tree ==8)
group_data_x[[7]] <- subset(apple, tree==2 | tree==7 | tree==12 | tree ==3)
group_data_y <- list()
group_data_y[[1]] <- y[y$species=="cherry",]
apple <- y[y$species=="apple",]
group_data_y[[2]] <- subset(apple, tree==20 | tree==19 | tree==14)
group_data_y[[3]] <- subset(apple, tree==17 | tree==15 | tree==18)
group_data_y[[4]] <- subset(apple, tree==13)
group_data_y[[5]] <- subset(apple, tree==10 | tree==1 | tree==4 | tree ==9)
group_data_y[[6]] <- subset(apple, tree==5 | tree==11 | tree==6 | tree ==8)
group_data_y[[7]] <- subset(apple, tree==2 | tree==7 | tree==12 | tree ==3)
plot(group_data_x[[1]][,3], group_data_y[[1]][,3],
xlim = c((min(x[,3], na.rm=T)-0.2),(max(x[,3], na.rm=T)+0.2)),
ylim = c((min(y[,3], na.rm=T)-0.2),(max(y[,3], na.rm=T)+0.2)),
xlab = labx, ylab = laby, cex.lab = 1.5, cex = 1.5, pch = 21, col = "red", bg = "red")
points(group_data_x[[2]][,3], group_data_y[[2]][,3], cex = 1.5, pch = 21, col = "black", bg = "orange")
points(group_data_x[[3]][,3], group_data_y[[3]][,3], cex = 1.5, pch = 21, col = "black", bg = 'yellow')
points(group_data_x[[4]][,3], group_data_y[[4]][,3], cex = 1.5, pch = 21, col = "black", bg = 'green')
points(group_data_x[[5]][,3], group_data_y[[5]][,3], cex = 1.5, pch = 21, col = "black", bg = 'cyan')
points(group_data_x[[6]][,3], group_data_y[[6]][,3], cex = 1.5, pch = 21, col = "black", bg = 'blue')
points(group_data_x[[7]][,3], group_data_y[[7]][,3], cex = 1.5, pch = 21, col = "black", bg = 'purple')
abline(coef.sma(test)[1], coef.sma(test)[2], lwd = 3, lty = 2)
abline(sma(test)$coef[[1]][1,2], sma(test)$coef[[1]][2,2], lwd = 3, lty = 3)
abline(sma(test)$coef[[1]][1,3], sma(test)$coef[[1]][2,3], lwd = 3, lty = 3)
abline(pred_b, pred_m, lwd = 3, lty = 1)
legend(position, legend=R2, bty='n', cex=3)
} #branch-level no log-trans
Diameter_Mass <- sma(log10(treesum$tot_stem_m)~log10(treesum$trunk_diam), slope.test = 2.67)
tree_graph(treesum$trunk_diam, treesum$tot_stem_m, Diameter_Mass, 0, 2.67,
"log ( Trunk Diameter  )", "log ( Total Stem Mass )", 'bottomright', expression(R^2 == 0.974))
diameter_mass <- sma(log10(branch_size$tot_stem_m)~log10(branch_size$diameter_mm))
branch_graph(subset(branch_size, select = c(species, tree, diameter_mm)),
subset(branch_size, select = c(species, tree, tot_stem_m)),
diameter_mass, 0, 2.67, "log ( Diameter  )", "log ( Total Stem Mass )",
'bottomright', expression(R^2 == 0.905))
Diameter_Height <- sma(log10(treesum$height)~log10((treesum$trunk_diam/2)))
tree_graph((treesum$trunk_diam/2), treesum$height, Diameter_Height, coef.sma(Diameter_Height)[1], 0.67,
"log ( Trunk Diameter  )", "log ( Height )", 'bottomright', expression(R^2 == 0.849))
diameter_path <- sma(log10(branch_size$path_length)~log10(branch_size$diameter_mm))
branch_graph(subset(branch_size, select = c(species, tree, diameter_mm)),
subset(branch_size, select = c(species, tree, path_length)),
diameter_path, coef.sma(diameter_path)[1], 0.67, "log ( Diameter  )", "log ( Path Length )",
'bottomright', expression(R^2 == 0.442))
Height_Mass <- sma(log10(treesum$height)~log10(treesum$tot_stem_m))
tree_graph(treesum$tot_stem_m, treesum$height, Height_Mass, coef.sma(Height_Mass)[1], 0.25,
"log ( Total Stem Mass  )", "log ( Height )", 'bottomright', expression(R^2 == 0.849))
length_mass <- sma(log10(branch_size$path_length)~log10(branch_size$tot_stem_m))
branch_graph(subset(branch_size, select = c(species, tree, tot_stem_m)),
subset(branch_size, select = c(species, tree, path_length)),
length_mass, coef.sma(length_mass)[1], 0.25, "log ( Total Stem Mass  )", "log ( Path Length )",
'bottomright', expression(R^2 == 0.632))
dratio_temp_na <- subset(branch_size, select = c(species, tree, diameter_mm, diameter_ratio))
dratio_temp <- na.omit(dratio_temp_na)
parent_diam <- data.frame(species = dratio_temp$species, tree = dratio_temp$tree,
ratio = dratio_temp$diameter_mm/dratio_temp$diameter_ratio)
diameter_ratio <- sma(dratio_temp$diameter_mm~parent_diam$ratio)
branch_graph2(parent_diam, dratio_temp, diameter_ratio, 0, 0.5, "Parent Diameter", "Daughter Diameter",
'topleft', expression(R^2 == 0.632))
lratio_temp_na <- subset(branch_size, select = c(species, tree, path_length, path_ratio))
lratio_temp <- na.omit(lratio_temp_na)
parent_path <- data.frame(species = lratio_temp$species, tree = lratio_temp$tree,
ratio = lratio_temp$path_length/lratio_temp$path_ratio)
path_ratio <- sma(lratio_temp$path_length~parent_path$ratio)
branch_graph2(parent_path, lratio_temp, path_ratio, 0, 0.5, "Parent Path Length",
"Daughter Path Length",'topleft', expression(R^2 == 0.545))
Diameter_Volume <- sma(log10(treesum$canopy_volume)~log10(treesum$trunk_diam))
tree_graph(treesum$trunk_diam, treesum$canopy_volume, Diameter_Volume, coef.sma(Diameter_Volume)[1], 1,
"log ( Trunk Diameter  )", "log ( Canopy Volume )", 'bottomright', expression(R^2 == 0.716))
