mass_fractions[j,6] = round(sd(paths), digits = 3)
mass_fractions[j,7] = as.integer(length(paths))
}
spp <- data[data$species=="cherry",]
for (j in 1:length(cherry_trees)){
subdata <- spp[spp$tree==cherry_trees[j],]
mass_fractions[j,1] = "cherry"
mass_fractions[j,2] = cherry_trees[j]
total_mass = 0
paths <- c()
for (i in 1:length(subdata[,1])){
if (!(i %in% subdata$parent)){
total_mass = 0
path_mass = sum_down_mass(subdata$branch[i])
paths <- c(paths,path_mass)
}
}
mass_fraction = mean(paths)/max(paths)
mass_fractions[j,3] = round(mass_fraction, digits = 3)
mass_fractions[j,4] = max(paths)
mass_fractions[j,5] = round(mean(paths), digits = 3)
mass_fractions[j,6] = round(sd(paths), digits = 3)
mass_fractions[j,7] = as.integer(length(paths))
}
data <- read.csv("BranchSegments.csv", sep=',', head=T)
sum_down_mass <- function(start_node){
twig <- subdata[subdata$branch==start_node,]
total_mass = total_mass + as.numeric(as.character(twig$stem_m))
if (twig$parent==0)
return(total_mass)
else
return(total_mass + sum_down_mass(twig$parent))
}
mass_fractions <- matrix(ncol=7, nrow=24)
colnames(mass_fractions) <- c("species", "tree", "Mf", "max_path", "avg_mass", "sd_mass", "no_stems")
apple_trees <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20)
cherry_trees <- c(1,7,10,13,15)
spp <- data[data$species=="apple",]
for (j in 1:length(apple_trees)){
subdata <- spp[spp$tree==apple_trees[j],]
mass_fractions[j,1] = "apple"
mass_fractions[j,2] = apple_trees[j]
total_mass = 0
paths <- c()
for (i in 1:length(subdata[,1])){
if (!(i %in% subdata$parent)){
total_mass = 0
path_mass = sum_down_mass(subdata$branch[i])
paths <- c(paths,path_mass)
}
}
mass_fraction = mean(paths)/max(paths)
mass_fractions[j,3] = round(mass_fraction, digits = 3)
mass_fractions[j,4] = max(paths)
mass_fractions[j,5] = round(mean(paths), digits = 3)
mass_fractions[j,6] = round(sd(paths), digits = 3)
mass_fractions[j,7] = as.integer(length(paths))
}
spp <- data[data$species=="cherry",]
for (j in 1:length(cherry_trees)){
subdata <- spp[spp$tree==cherry_trees[j],]
mass_fractions[j,1] = "cherry"
mass_fractions[j,2] = cherry_trees[j]
total_mass = 0
paths <- c()
for (i in 1:length(subdata[,1])){
if (!(i %in% subdata$parent)){
total_mass = 0
path_mass = sum_down_mass(subdata$branch[i])
paths <- c(paths,path_mass)
}
}
mass_fraction = mean(paths)/max(paths)
mass_fractions[j,3] = round(mass_fraction, digits = 3)
mass_fractions[j,4] = max(paths)
mass_fractions[j,5] = round(mean(paths), digits = 3)
mass_fractions[j,6] = round(sd(paths), digits = 3)
mass_fractions[j,7] = as.integer(length(paths))
}
View(mass_fractions)
data <- read.csv("BranchSegments.csv", sep=',', head=T)
sum_down_mass <- function(start_node){
twig <- subdata[subdata$branch==start_node,]
total_mass = total_mass + as.numeric(as.character(twig$stem_m))
if (twig$parent==0)
return(total_mass)
else
return(total_mass + sum_down_mass(twig$parent))
}
mass_fractions <- matrix(ncol=7, nrow=24)
colnames(mass_fractions) <- c("species", "tree", "Mf", "max_path", "avg_mass", "sd_mass", "no_stems")
apple_trees <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20)
cherry_trees <- c(1,7,10,13,15)
spp <- data[data$species=="apple",]
for (j in 1:length(apple_trees)){
subdata <- spp[spp$tree==apple_trees[j],]
mass_fractions[j,1] = "apple"
mass_fractions[j,2] = apple_trees[j]
total_mass = 0
paths <- c()
for (i in 1:length(subdata[,1])){
if (!(i %in% subdata$parent)){
total_mass = 0
path_mass = sum_down_mass(subdata$branch[i])
paths <- c(paths,path_mass)
}
}
mass_fraction = mean(paths)/max(paths)
mass_fractions[j,3] = round(mass_fraction, digits = 3)
mass_fractions[j,4] = max(paths)
mass_fractions[j,5] = round(mean(paths), digits = 3)
mass_fractions[j,6] = round(sd(paths), digits = 3)
mass_fractions[j,7] = as.integer(length(paths))
}
spp <- data[data$species=="cherry",]
for (j in 1:length(cherry_trees)){
subdata <- spp[spp$tree==cherry_trees[j],]
mass_fractions[(j+19),1] = "cherry"
mass_fractions[(j+19),2] = cherry_trees[j]
total_mass = 0
paths <- c()
for (i in 1:length(subdata[,1])){
if (!(i %in% subdata$parent)){
total_mass = 0
path_mass = sum_down_mass(subdata$branch[i])
paths <- c(paths,path_mass)
}
}
mass_fraction = mean(paths)/max(paths)
mass_fractions[(j+19),3] = round(mass_fraction, digits = 3)
mass_fractions[(j+19),4] = max(paths)
mass_fractions[(j+19),5] = round(mean(paths), digits = 3)
mass_fractions[(j+19),6] = round(sd(paths), digits = 3)
mass_fractions[(j+19),7] = as.integer(length(paths))
}
View(mass_fractions)
write.csv(mass_fractions,"MassFractions.csv")
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
names(Pf)
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
c("CG.6210", "Bud.9", "Bud.9", "CG.6210", "CG.3041",
"CG.3041", "Bud.9", "CG.3041", "CG.6210", "CG.6210",
"CG.3041", "Bud.9", "M.26", "PiAu.5683", "JM.8",
"JM.8", "JM.8", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(1,7,10,13,15),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = subset(spp_pf, tree == species[[i]][[2]][j], select = max_path)
subout[j,7]  = subset(spp_pf, tree == species[[i]][[2]][j], select = Pf)
subout[j,8]  = subset(spp_pf, tree == species[[i]][[2]][j], select = Mf)
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
#write.csv(trees_out,"TreeSummary.csv")
View(subout)
species[[i]][[2]][j]
subset(spp_pf, tree == species[[i]][[2]][j], select = max_path)
head(spp_pf)
subset(spp_pf, tree == species[[i]][[2]][j])
j
subset(spp_pf, tree == 1)
subset(spp_pf, tree == (species[[i]][[2]][j]))
species[[i]][[2]][j]
species[[i]][[2]][j][1]
species[[i]][[2]][j][0]
species[[i]][[2]][j][1]
species[[i]][[2]][j][1][1]
subset(spp_pf, spp_pf$tree == species[[i]][[2]][j], select = max_path)
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
c("CG.6210", "Bud.9", "Bud.9", "CG.6210", "CG.3041",
"CG.3041", "Bud.9", "CG.3041", "CG.6210", "CG.6210",
"CG.3041", "Bud.9", "M.26", "PiAu.5683", "JM.8",
"JM.8", "JM.8", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(1,7,10,13,15),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_pf <- spp_pf[spp_pf$tree==species[[i]][[2]][j],]
ind_mf <- spp_mf[spp_mf$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = ind_pf$max_path
subout[j,7]  = ind_pf$Pf
subout[j,8]  = ind_mf$Mf
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
#write.csv(trees_out,"TreeSummary.csv")
View(trees_out)
write.csv(trees_out,"TreeSummary.csv")
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(2,7,12,3,5,11,6,8,10,1,4,9,13,17,15,18,20,19,14),
c("Bud.9", "Bud.9", "Bud.9", "Bud.9", "CG.3041", "CG.3041",
"CG.3041", "CG.3041", "CG.6210", "CG.6210", "CG.6210",
"CG.6210", "M.26", "JM.8", "JM.8", "JM.8",
"PiAu.5683", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(7,13,15,1,10),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_pf <- spp_pf[spp_pf$tree==species[[i]][[2]][j],]
ind_mf <- spp_mf[spp_mf$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = ind_pf$max_path
subout[j,7]  = ind_pf$Pf
subout[j,8]  = ind_mf$Mf
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
write.csv(trees_out,"TreeSummary.csv")
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(2,7,12,3,5,11,6,8,10,1,4,9,13,17,15,18,20,19,14),
c("Bud.9", "Bud.9", "Bud.9", "Bud.9", "CG.3041", "CG.3041",
"CG.3041", "CG.3041", "CG.6210", "CG.6210", "CG.6210",
"CG.6210", "M.26", "JM.8", "JM.8", "JM.8",
"PiAu.5683", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(7,13,15,1,10),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_pf <- spp_pf[spp_pf$tree==species[[i]][[2]][j],]
ind_mf <- spp_mf[spp_mf$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = ind_pf$max_path
subout[j,7]  = ind_pf$Pf
subout[j,8]  = ind_mf$Mf
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
write.csv(trees_out,"TreeSummary.csv")
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(2,7,12,3,5,11,6,8,10,1,4,9,13,17,15,18,20,19,14),
c("Bud.9", "Bud.9", "Bud.9", "Bud.9", "CG.3041", "CG.3041",
"CG.3041", "CG.3041", "CG.6210", "CG.6210", "CG.6210",
"CG.6210", "M.26", "JM.8", "JM.8", "JM.8",
"PiAu.5683", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(7,13,15,1,10),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_pf <- spp_pf[spp_pf$tree==species[[i]][[2]][j],]
ind_mf <- spp_mf[spp_mf$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = ind_pf$max_path
subout[j,7]  = ind_pf$Pf
subout[j,8]  = ind_mf$Mf
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
#write.csv(trees_out,"TreeSummary.csv")
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
Pf <- read.csv("PathFractionsBranch.csv", sep=",", head=T)
Mf <- read.csv("MassFractions.csv", sep=",", head=T)
species <- list(list("apple",
c(2,7,12,3,5,11,6,8,10,1,4,9,13,17,15,18,20,19,14),
c("Bud.9", "Bud.9", "Bud.9", "Bud.9", "CG.3041", "CG.3041",
"CG.3041", "CG.3041", "CG.6210", "CG.6210", "CG.6210",
"CG.6210", "M.26", "JM.8", "JM.8", "JM.8",
"PiAu.5683", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(7,13,15,1,10),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_pf <- Pf[Pf$species==species[[i]][1],]
spp_mf <- Mf[Mf$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 19, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "max_path", "Pf", "Mf",
"canopy_volume", "tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_pf <- spp_pf[spp_pf$tree==species[[i]][[2]][j],]
ind_mf <- spp_mf[spp_mf$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = ind_pf$max_path
subout[j,7]  = ind_pf$Pf
subout[j,8]  = ind_mf$Mf
subout[j,9]  = round(ind_volume$avg_r, digits = 1)
subout[j,10]  = sum(ind$stem_m, na.rm = T)
subout[j,11]  = sum(ind$twig_m, na.rm = T)
subout[j,12]  = sum(ind$leaf_m, na.rm = T)
subout[j,13] = length(ind$branch)
subout[j,14] = sum(ind$no_twigs, na.rm = T)
subout[j,15] = sum(ind$no_spurs, na.rm = T)
subout[j,16] = sum(ind$no_scars, na.rm = T)
subout[j,17] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,18] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,19] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
#write.csv(trees_out,"TreeSummary.csv")
View(trees_out)
write.csv(trees_out,"TreeSummary.csv")
