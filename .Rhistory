setwd("~/Desktop/branch-arch")
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
list("cherry",
c(1,7,10,13,15))))
species[1]
species[1][1]
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20))
list("cherry",
c(1,7,10,13,15)))
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20)),
list("cherry",
c(1,7,10,13,15)))
species[1]
species[1][1]
species[[1]][1]
species[[1]][2]
species[[1]][[0]]
species[[1]][[1]]
species[[1]][[2]]
species[[[1]]][[2]]
species[[[1]]][2]
ratios <- matrix(nrow = 829, ncol = 5)
species[[1]][1]
is.character(species[[1]][1]
)
is.string(species[[1]][1]
)
i=1
spp <- branch_size[branch_size$species==species[[i]][1],]
names(branch_size)
ratios <- matrix(nrow = 829, ncol = 5)
for (i in 1:829){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
}
View(ratios)
unique(branch_size$species)
ratios <- data.frame(nrow = 829, ncol = 5)
for (i in 1:829){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
}
View(ratios)
branch_size$species[i]
branch_size$species[3]
for (i in 1:829){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]]
}
branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]]
branch_size$length_cm[i]
branch_size$length_cm[i] +10
branch_size$length_cm[branch_size$parent[i]]
branch_size$parent[i]
for (i in 1:829){
parent = branch_size$parent[i]
if (parent > 0){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = branch_size$length_cm[i] / branch_size$length_cm[parent]
}
}
parent
branch_size$parent[376]
branch_size$length_cm[376]
branch_size$tree[376]
branch_size$id[376]
branch_size$branch[376]
for (i in 1:829){
if (branch_size$branch[i] > 1){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]]
}
}
View(ratios)
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]]
ratios[i,4] = branch_size$diameter_mm[i] / branch_size$length_cm[branch_size$diameter_mm[i]]
ratios[i,5] = branch_size$stem_m[i] / branch_size$length_cm[branch_size$stem_m[i]]
}
}
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]]
ratios[i,4] = branch_size$diameter_mm[i] / branch_size$diameter_mm[branch_size$parent[i]]
ratios[i,5] = branch_size$stem_m[i] / branch_size$stem_m[branch_size$parent[i]]
}
}
View(ratios)
write.csv(ratios, "ratios.csv")
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = round(branch_size$length_cm[i] / branch_size$length_cm[branch_size$parent[i]],3)
ratios[i,4] = round(branch_size$diameter_mm[i] / branch_size$diameter_mm[branch_size$parent[i]],3)
ratios[i,5] = round(branch_size$stem_m[i] / branch_size$stem_m[branch_size$parent[i]],3)
}
}
write.csv(ratios, "ratios.csv")
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
c("CG.6210", "Bud.9", "Bud.9", "CG.6210", "CG.3041",
"CG.3041", "Bud.9", "CG.3041", "CG.6210", "CG.6210",
"CG.3041", "Bud.9", "M.26", "PiAu.5683", "JM.8",
"JM.8", "JM.8", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(1,7,10,13,15),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 16, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "canopy_volume",
"tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = round(ind_volume$avg_r, digits = 1)
subout[j,7]  = sum(ind$stem_m, na.rm = T)
subout[j,8]  = sum(ind$twig_m, na.rm = T)
subout[j,9]  = sum(ind$leaf_m, na.rm = T)
subout[j,10] = length(ind$branch)
subout[j,11]  = sum(ind$no_twigs, na.rm = T)
subout[j,12]  = sum(ind$no_spurs, na.rm = T)
subout[j,13]  = sum(ind$no_scars, na.rm = T)
subout[j,14] = mean(ind$length_ratio, na.rm=T)
subout[j,15] = mean(ind$diameter_ratio, na.rm=T)
subout[j,16] = mean(ind$mass_ratio, na.rm=T)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
View(trees_out)
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
i=4
if (branch_size$branch[i] > 1){
spp <- branch_size[branch_size$species == branch_size$species[i],]
tree <- spp[spp$tree == branch_size$tree[i],]
parent <- tree[tree$branch == branch_size$parent[i],]
}
parent
branch_size[4]
branch_size[4,]
parent$length_cm
parent$length_cm+2
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
spp <- branch_size[branch_size$species == branch_size$species[i],]
tree <- spp[spp$tree == branch_size$tree[i],]
parent <- tree[tree$branch == branch_size$parent[i],]
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = round(branch_size$length_cm[i] / parent$length_cm,3)
ratios[i,4] = round(branch_size$diameter_mm[i] / parent$diameter_mm,3)
ratios[i,5] = round(branch_size$stem_m[i] / parent$stem_m,3)
}
}
parent$length_cm
parent
branch_size$parent[i]
length(tree[,1])
branch_size[i,]
tree[tree$branch == branch_size$parent[i],]
tree[tree$branch == 39,]
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
spp <- branch_size[branch_size$species == branch_size$species[i],]
tree <- spp[spp$tree == branch_size$tree[i],]
parent <- tree[tree$branch == branch_size$parent[i],]
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = round(branch_size$length_cm[i] / parent$length_cm,3)
ratios[i,4] = round(branch_size$diameter_mm[i] / parent$diameter_mm,3)
ratios[i,5] = round(branch_size$stem_m[i] / parent$stem_m,3)
}
}
View(ratios)
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
spp <- branch_size[branch_size$species == branch_size$species[i],]
tree <- spp[spp$tree == branch_size$tree[i],]
parent <- tree[tree$branch == branch_size$parent[i],]
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = round(branch_size$length_cm[i] / parent$length_cm,3)
ratios[i,4] = round(branch_size$diameter_mm[i] / parent$diameter_mm,3)
ratios[i,5] = round(branch_size$stem_m[i] / parent$stem_m,3)
}
}
View(ratios)
max(ratios[,4])
max(ratios[,4], rm.na=T)
max(ratios[,4], na.rm=T)
branch_size <- read.csv("BranchSegments.csv", sep = ',', header = T)
ratios <- matrix(nrow = 829, ncol = 5)
colnames(ratios) <- c("species", "tree", "length_ratio", "diameter_ratio", "mass_ratio")
for (i in 1:829){
if (branch_size$branch[i] > 1){
spp <- branch_size[branch_size$species == branch_size$species[i],]
tree <- spp[spp$tree == branch_size$tree[i],]
parent <- tree[tree$branch == branch_size$parent[i],]
ratios[i,1] = branch_size$species[i]
ratios[i,2] = branch_size$tree[i]
ratios[i,3] = round(branch_size$length_cm[i] / parent$length_cm,3)
ratios[i,4] = round(branch_size$diameter_mm[i] / parent$diameter_mm,3)
ratios[i,5] = round(branch_size$stem_m[i] / parent$stem_m,3)
}
}
max(ratios[,4], na.rm=T)
length(ratios[ratios[,4] < 1])
length(ratios[ratios[,4] < 1][,1])
length(ratios[ratios[,4] < 1,])
qwe<-ratios[ratios[,4] < 1,]
write.csv(ratios, "ratios.csv")
write.csv(ratios, "ratios.csv")
# This script summarizes individual tree-level data.
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
c("CG.6210", "Bud.9", "Bud.9", "CG.6210", "CG.3041",
"CG.3041", "Bud.9", "CG.3041", "CG.6210", "CG.6210",
"CG.3041", "Bud.9", "M.26", "PiAu.5683", "JM.8",
"JM.8", "JM.8", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(1,7,10,13,15),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 16, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "canopy_volume",
"tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = round(ind_volume$avg_r, digits = 1)
subout[j,7]  = sum(ind$stem_m, na.rm = T)
subout[j,8]  = sum(ind$twig_m, na.rm = T)
subout[j,9]  = sum(ind$leaf_m, na.rm = T)
subout[j,10] = length(ind$branch)
subout[j,11]  = sum(ind$no_twigs, na.rm = T)
subout[j,12]  = sum(ind$no_spurs, na.rm = T)
subout[j,13]  = sum(ind$no_scars, na.rm = T)
subout[j,14] = mean(ind$length_ratio, na.rm=T)
subout[j,15] = mean(ind$diameter_ratio, na.rm=T)
subout[j,16] = mean(ind$mass_ratio, na.rm=T)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
View(trees_out)
data <- read.csv("BranchSegments.csv", sep = ",", head=T)
volume <- read.csv("VolumeEstimates.csv", sep=",", head=T)
species <- list(list("apple",
c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20),
c("CG.6210", "Bud.9", "Bud.9", "CG.6210", "CG.3041",
"CG.3041", "Bud.9", "CG.3041", "CG.6210", "CG.6210",
"CG.3041", "Bud.9", "M.26", "PiAu.5683", "JM.8",
"JM.8", "JM.8", "PiAu.5683", "PiAu.5683")),
list("cherry",
c(1,7,10,13,15),
"P. mahaleb"))
for (i in 1:2){
spp <- data[data$species==species[[i]][1],]
spp_volume <- volume[volume$species==species[[i]][1],]
subout <- matrix(ncol = 16, nrow = length(species[[i]][[2]]))
colnames(subout) <- c("species", "tree", "rootstock", "trunk_diam", "height", "canopy_volume",
"tot_stem_m", "tot_twig_m", "tot_leaf_m",
"tot_no_branch", "tot_no_twigs", "tot_no_spurs", "tot_no_scars",
"avg_length_ratio", "avg_diameter_ratio", "avg_mass_ratio")
for (j in 1:length(species[[i]][[2]])){
ind <- spp[spp$tree==species[[i]][[2]][j],]
ind_volume <- spp_volume[spp_volume$tree==species[[i]][[2]][j],]
trunk <- ind[ind$branch==1,]
subout[j,1] = species[[i]][[1]]
subout[j,2] = species[[i]][[2]][j]
if (i==1)
subout[j,3] = species[[i]][[3]][j]
else
subout[j,3] = species[[i]][[3]][1]
subout[j,4]  = trunk$diameter_mm
subout[j,5]  = round(ind_volume$height, digits = 1)
subout[j,6]  = round(ind_volume$avg_r, digits = 1)
subout[j,7]  = sum(ind$stem_m, na.rm = T)
subout[j,8]  = sum(ind$twig_m, na.rm = T)
subout[j,9]  = sum(ind$leaf_m, na.rm = T)
subout[j,10] = length(ind$branch)
subout[j,11]  = sum(ind$no_twigs, na.rm = T)
subout[j,12]  = sum(ind$no_spurs, na.rm = T)
subout[j,13]  = sum(ind$no_scars, na.rm = T)
subout[j,14] = round(mean(ind$length_ratio, na.rm=T),3)
subout[j,15] = round(mean(ind$diameter_ratio, na.rm=T),3)
subout[j,16] = round(mean(ind$mass_ratio, na.rm=T),3)
if (i==1)
trees_temp <- subout
else
trees_out = rbind(trees_temp, subout)
}
}
write.csv(trees_out,"TreeSummary.csv")
data <- read.csv("TreeReconstruction.csv", sep = ',', header = T)
branch <- read.csv("BranchSegments.csv", sep = ',', header = T)
treesum <- read.csv("TreeSummary.csv", sep = ",", head=T)
plot(treesum$trunk_diameter, treesum$avg_length_ratio)
names(tree_sum)
names(treesum)
plot(treesum$trunk_diam, treesum$avg_length_ratio)
names(branch)
plot(branch$diamter_mm, branch$diameter_ratio)
plot(branch$diameter_mm, branch$diameter_ratio)
plot(branch$order, branch$diameter_ratio)
plot(branch$length_cm, branch$length_ratio)
plot(branch$diameter_mm, branch$diameter_ratio, ylim = c(0,1))
plot(branch$order, branch$length_ratio)
plot(treesum$trunk_diam, treesum$avg_diameter_ratio)
plot(treesum$trunk_diam, treesum$avg_length_ratio)
plot(treesum$trunk_diam, treesum$avg_mass_ratio)
plot(branch$stem_m, branch$mass_ratio)
plot(branch$stem_m, branch$mass_ratio, ylim = c(0,5))
plot(branch$order, branch$mass_ratio)
plot(branch$diameter_mm, branch$diameter_ratio, ylim = c(0,1))
plot(branch$diameter_mm, branch$diameter_ratio)#, ylim = c(0,1))
plot(branch$length_cm, branch$length_ratio)
plot(branch$diameter_mm, branch$length_ratio)
plot(branch$stem_m, branch$length_ratio)
plot(branch$diameter_mm, branch$mass_ratio)
